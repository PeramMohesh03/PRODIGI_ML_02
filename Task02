import pandas as pd
from sklearn.cluster import KMeans
from sklearn.preprocessing import StandardScaler

# Load customer purchase data
data = pd.read_csv('customer_purchase_data.csv')

# Feature selection and preprocessing
features = ['product_category_1', 'product_category_2', 'purchase_frequency', 'purchase_amount']
X = data[features]
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

# Determine optimal number of clusters (using elbow method or silhouette analysis)
# ...

# Apply K-Means clustering
kmeans = KMeans(n_clusters=optimal_k, random_state=42)
kmeans.fit(X_scaled)

# Assign cluster labels to customers
data['cluster'] = kmeans.labels_
